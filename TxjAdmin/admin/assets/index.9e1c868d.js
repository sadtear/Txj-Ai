import{W as de,X as pe,D as me,F as ce,C as _e,B as fe,w as ve,G as ge,H as we,I as Ee,t as ke,J as be,K as he,P as Ve}from"./element-plus.28f30ed2.js";import{_ as ye}from"./index.vue_vue_type_script_setup_true_lang.f7bc22c4.js";import{_ as Ce}from"./index.vue_vue_type_script_setup_true_lang.cf0c4941.js";import{r as B,f as D,_ as Fe,d as De}from"./index.93d1c242.js";import{u as xe}from"./useDictOptions.e0665b3b.js";import{u as Se}from"./usePaging.5f3fbca9.js";import{d as J,s as Be,r as h,_ as Ie,ag as Ae,ar as Ue,o,c as x,V as a,M as l,u as t,U as R,aa as $,L as r,S as v,a as E,O as g,R as S,T as Re,k as W,n as z}from"./@vue.cb90fff3.js";import"./lodash-es.020a3960.js";import"./async-validator.fb49d0f5.js";import"./@vueuse.54201ba6.js";import"./@element-plus.36ce49f2.js";import"./dayjs.38099f94.js";import"./axios.db0b6952.js";import"./@ctrl.b082b0c1.js";import"./@popperjs.36402333.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./lodash.265ebbd3.js";import"./vue-router.bee126d8.js";import"./pinia.66d683d1.js";import"./vue-demi.b3a9cad9.js";import"./css-color-function.d9c88729.js";import"./color.8789f62b.js";import"./clone.7ebdaffc.js";import"./color-convert.755d189f.js";import"./color-name.e7a4e1d3.js";import"./color-string.e356f5de.js";import"./balanced-match.d2a36341.js";import"./debug.e8a38282.js";import"./ms.a9ae1d6d.js";import"./vue-drag-resize.44c30f3e.js";import"./nprogress.a77a2697.js";import"./vue-clipboard3.70be7e6e.js";import"./clipboard.551ce183.js";import"./echarts.f889f12e.js";import"./zrender.ec6da783.js";import"./tslib.60310f1a.js";import"./highlight.js.9905ea4d.js";import"./@highlightjs.ae4f7a48.js";import"./dict.180d0b3e.js";function $e(m){return B.get({url:"/work/list",params:m})}function He(m){return B.post({url:"/work/del",params:m})}function Pe(m){return B.post({url:"/work/change",params:m})}function Te(m){return B.post({url:"/work/changeHot",params:m})}function Le(m){return B.post({url:"/work/reviewWorks",params:m})}const je={class:"index-lists"},qe={class:"flex items-center"},Ne={class:"ml-4"},Me={class:"flex items-center"},Oe={class:"flex justify-end mt-4"},Ge={slot:"footer",class:"dialog-footer"},We=J({name:"work"}),Ua=J({...We,setup(m){const I=Be(),A=h(!1),i=Ie({userId:"",taskId:"",categoryId:"",styleId:"",cursesId:"",channel:"",approveStatus:"",usageMoney:"",hot:"",status:"",rejectReason:""}),k=h(!1),{pager:V,getLists:y,resetPage:K,resetParams:X}=Se({fetchFun:$e,params:i}),c=h({examineStatus:"",desc:""}),{dictData:w}=xe(["draw_channel","work_type","work_approve_status","hot","status"]),H=h(0),U=h(),Q=n=>{k.value=!0,H.value=n},C=h(!1),Y=()=>{console.log(U._rawValue),U._rawValue.validate(n=>{if(n){if(!C.value){let u={id:H.value};c.value.examineStatus=="\u901A\u8FC7"?u.approveStatus=1:c.value.examineStatus=="\u9A73\u56DE"&&(u.approveStatus=2,u.rejectReason=c.value.desc),C.value=!0,Le(u).then(d=>{D.msgSuccess("\u63D0\u4EA4\u6210\u529F"),k.value=!1,C.value=!1,y()}).catch(d=>{C.value=!1})}}else return console.log("\u8BF7\u8F93\u5165\u5FC5\u586B\u9879!"),!1})},P=()=>{H.value="",k.value=!1},Z=async()=>{var n;A.value=!0,await z(),(n=I.value)==null||n.open("add")},ee=async n=>{var u,d;A.value=!0,await z(),(u=I.value)==null||u.open("edit"),(d=I.value)==null||d.getDetail(n)},ae=async n=>{await D.confirm("\u786E\u5B9A\u8981\u5220\u9664\uFF1F"),await He({id:n}),D.msgSuccess("\u5220\u9664\u6210\u529F"),y()},le=async n=>{await Pe({id:n}),D.msgSuccess("\u4FEE\u6539\u6210\u529F")},te=async n=>{console.log("changeHot: ",n),await Te({id:n}),D.msgSuccess("\u4FEE\u6539\u6210\u529F")};return y(),(n,u)=>{const d=me,F=ce,_=_e,T=fe,f=ve,L=ge,j=we,ue=Fe,q=De,p=Ee,N=Ce,M=ke,oe=be,ne=ye,se=Ae("edit-popup"),O=de,re=pe,ie=he,b=Ue("perms"),G=Ve;return o(),x("div",je,[a(j,{class:"!border-none",shadow:"never"},{default:l(()=>[a(L,{ref_key:"formRef",ref:U,class:"mb-[-16px]",model:t(i),inline:!0},{default:l(()=>[a(_,{label:"\u5206\u7C7BID",prop:"categoryId"},{default:l(()=>[a(F,{modelValue:t(i).categoryId,"onUpdate:modelValue":u[0]||(u[0]=e=>t(i).categoryId=e),class:"w-[280px]",clearable:""},{default:l(()=>[a(d,{label:"\u8BF7\u9009\u62E9\u5B57\u5178\u751F\u6210",value:""})]),_:1},8,["modelValue"])]),_:1}),a(_,{label:"\u98CE\u683CID",prop:"styleId"},{default:l(()=>[a(T,{class:"w-[280px]",modelValue:t(i).styleId,"onUpdate:modelValue":u[1]||(u[1]=e=>t(i).styleId=e)},null,8,["modelValue"])]),_:1}),a(_,{label:"\u7ED8\u56FE\u6E20\u9053",prop:"channel"},{default:l(()=>[a(F,{modelValue:t(i).channel,"onUpdate:modelValue":u[2]||(u[2]=e=>t(i).channel=e),class:"w-[280px]",clearable:""},{default:l(()=>[a(d,{label:"\u5168\u90E8",value:""}),(o(!0),x(R,null,$(t(w).draw_channel,(e,s)=>(o(),r(d,{key:s,label:e.name,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(_,{label:"\u5BA1\u6279\u72B6\u6001",prop:"approveStatus"},{default:l(()=>[a(F,{modelValue:t(i).approveStatus,"onUpdate:modelValue":u[3]||(u[3]=e=>t(i).approveStatus=e),class:"w-[280px]",clearable:""},{default:l(()=>[a(d,{label:"\u5168\u90E8",value:""}),(o(!0),x(R,null,$(t(w).work_approve_status,(e,s)=>(o(),r(d,{key:s,label:e.name,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(_,{label:"\u70ED\u95E8",prop:"hot"},{default:l(()=>[a(F,{modelValue:t(i).hot,"onUpdate:modelValue":u[4]||(u[4]=e=>t(i).hot=e),class:"w-[280px]",clearable:""},{default:l(()=>[a(d,{label:"\u5168\u90E8",value:""}),(o(!0),x(R,null,$(t(w).hot,(e,s)=>(o(),r(d,{key:s,label:e.name,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(_,{label:"\u72B6\u6001",prop:"status"},{default:l(()=>[a(F,{modelValue:t(i).status,"onUpdate:modelValue":u[5]||(u[5]=e=>t(i).status=e),class:"w-[280px]",clearable:""},{default:l(()=>[a(d,{label:"\u5168\u90E8",value:""}),(o(!0),x(R,null,$(t(w).status,(e,s)=>(o(),r(d,{key:s,label:e.name,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(_,null,{default:l(()=>[a(f,{type:"primary",onClick:t(K)},{default:l(()=>[v("\u67E5\u8BE2")]),_:1},8,["onClick"]),a(f,{onClick:t(X)},{default:l(()=>[v("\u91CD\u7F6E")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1}),a(j,{class:"!border-none mt-4",shadow:"never"},{default:l(()=>[E("div",null,[g((o(),r(f,{type:"primary",onClick:u[6]||(u[6]=e=>Z())},{icon:l(()=>[a(ue,{name:"el-icon-Plus"})]),default:l(()=>[v(" \u65B0\u589E ")]),_:1})),[[b,["work:add"]]])]),g((o(),r(oe,{class:"mt-4",size:"large",data:t(V).lists},{default:l(()=>[a(p,{label:"\u7528\u6237\u4FE1\u606F","min-width":"140"},{default:l(({row:e})=>[E("div",qe,[e.avatar?(o(),r(q,{key:0,class:"flex-none",src:e.avatar,width:48,height:48,"preview-src-list":[e.avatar],"preview-teleported":"",fit:"contain"},null,8,["src","preview-src-list"])):S("",!0),E("span",Ne,Re(e.nickname),1)])]),_:1}),a(p,{label:"\u4F5C\u54C1\u56FE\u7247","min-width":"140"},{default:l(({row:e})=>[E("div",Me,[e.thumbnail?(o(),r(q,{key:0,class:"flex-none",src:e.thumbnail,width:48,height:48,"preview-src-list":[e.thumbnail],"preview-teleported":"",fit:"contain"},null,8,["src","preview-src-list"])):S("",!0)])]),_:1}),a(p,{label:"\u5206\u7C7BID",prop:"categoryId","min-width":"100"}),a(p,{label:"\u98CE\u683CID",prop:"styleId","min-width":"100"}),a(p,{label:"\u7ED8\u56FE\u6E20\u9053",prop:"channel","min-width":"100"},{default:l(({row:e})=>[a(N,{options:t(w).draw_channel,value:e.channel},null,8,["options","value"])]),_:1}),a(p,{label:"\u4F7F\u7528\u91D1\u989D(\u91D1\u5E01)",prop:"usageMoney","min-width":"100"}),g((o(),r(p,{label:"\u70ED\u95E8","min-width":"100"},{default:l(({row:e})=>[a(M,{modelValue:e.hot,"onUpdate:modelValue":s=>e.hot=s,"active-value":1,"inactive-value":0,onChange:s=>te(e.id)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})),[[b,["ai:draw:prompt:changeHot"]]]),g((o(),r(p,{label:"\u72B6\u6001","min-width":"100"},{default:l(({row:e})=>[a(M,{modelValue:e.status,"onUpdate:modelValue":s=>e.status=s,"active-value":1,"inactive-value":0,onChange:s=>le(e.id)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})),[[b,["ai:draw:prompt:changeStatus"]]]),a(p,{label:"\u5BA1\u6279\u72B6\u6001",prop:"approveStatus","min-width":"100"},{default:l(({row:e})=>[a(N,{options:t(w).work_approve_status,value:e.approveStatus},null,8,["options","value"])]),_:1}),a(p,{label:"\u9A73\u56DE\u539F\u56E0",prop:"rejectReason","min-width":"100"}),a(p,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime","min-width":"100"}),a(p,{label:"\u64CD\u4F5C",width:"120",fixed:"right"},{default:l(({row:e})=>[e.approveStatus=="0"?g((o(),r(f,{key:0,type:"primary",link:"",onClick:s=>Q(e.id)},{default:l(()=>[v(" \u5BA1\u6838 ")]),_:2},1032,["onClick"])),[[b,["work:examine"]]]):S("",!0),g((o(),r(f,{type:"primary",link:"",onClick:s=>ee(e)},{default:l(()=>[v(" \u7F16\u8F91 ")]),_:2},1032,["onClick"])),[[b,["work:edit"]]]),g((o(),r(f,{type:"danger",link:"",onClick:s=>ae(e.id)},{default:l(()=>[v(" \u5220\u9664 ")]),_:2},1032,["onClick"])),[[b,["work:del"]]])]),_:1})]),_:1},8,["data"])),[[G,t(V).loading]]),E("div",Oe,[a(ne,{modelValue:t(V),"onUpdate:modelValue":u[7]||(u[7]=e=>W(V)?V.value=e:null),onChange:t(y)},null,8,["modelValue","onChange"])])]),_:1}),t(A)?(o(),r(se,{key:0,ref_key:"editRef",ref:I,"dict-data":t(w),onSuccess:t(y),onClose:u[8]||(u[8]=e=>A.value=!1)},null,8,["dict-data","onSuccess"])):S("",!0),a(ie,{title:"\u5BA1\u6838",modelValue:t(k),"onUpdate:modelValue":u[11]||(u[11]=e=>W(k)?k.value=e:null),width:"40%","before-close":P},{default:l(()=>[E("div",null,[a(L,{ref_key:"formRef",ref:U,model:t(c),"label-width":"80px"},{default:l(()=>[a(_,{label:"\u5BA1\u6838",required:""},{default:l(()=>[a(re,{modelValue:t(c).examineStatus,"onUpdate:modelValue":u[9]||(u[9]=e=>t(c).examineStatus=e)},{default:l(()=>[a(O,{label:"\u901A\u8FC7",value:"0"}),a(O,{label:"\u9A73\u56DE",value:"1"})]),_:1},8,["modelValue"])]),_:1}),t(c).examineStatus=="\u9A73\u56DE"?(o(),r(_,{key:0,label:"\u9A73\u56DE\u539F\u56E0",required:""},{default:l(()=>[a(T,{type:"textarea",modelValue:t(c).desc,"onUpdate:modelValue":u[10]||(u[10]=e=>t(c).desc=e)},null,8,["modelValue"])]),_:1})):S("",!0)]),_:1},8,["model"])]),E("span",Ge,[a(f,{onClick:P},{default:l(()=>[v("\u53D6\u6D88")]),_:1}),g((o(),r(f,{type:"primary",onClick:Y},{default:l(()=>[v("\u786E\u5B9A")]),_:1})),[[G,t(C)]])])]),_:1},8,["modelValue"])])}}});export{Ua as default};
