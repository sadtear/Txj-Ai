import{A as ve,ai as re,bt as me,ah as de,v as U,dq as fe,dr as be,ds as Ie,J as pe,I as ge,ct as _e,r as k,dt as ze,a1 as Le,y as c,a2 as ie,Z as we,au as ye,o as g,m as ue,b as i,w as b,a as p,n as u,h as t,ab as ce,j as Ce,q as I,D as N,G as Ee,c as E,F as Q,bx as xe,az as Ne,du as Se,aq as Oe,W as Te,dv as $e,dw as Ae,i as Re,M as Me,P as Ve,O as J,T as Be,Q as Ye,_ as ke,b7 as M,aL as V,dx as De,R as he,dy as Pe,dz as Xe,cg as X,t as Fe,N as He,ch as je,ak as qe,$ as Ke,dA as We}from"./entry.35d4c246.js";import{t as le}from"./throttle.203d98ad.js";import{i as Ze}from"./position.fdd244ba.js";const Ge=ve({urlList:{type:re(Array),default:()=>me([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),Je={close:()=>!0,switch:w=>de(w)},Qe=["src"],Ue=U({name:"ElImageViewer"}),ea=U({...Ue,props:Ge,emits:Je,setup(w,{expose:S,emit:v}){const l=w,O={CONTAIN:{name:"contain",icon:fe(be)},ORIGINAL:{name:"original",icon:fe(Ie)}},{t:_}=pe(),o=ge("image-viewer"),{nextZIndex:ee}=_e(),T=k(),x=k([]),z=ze(),h=k(!0),d=k(l.initialIndex),f=Le(O.CONTAIN),r=k({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),B=c(()=>{const{urlList:e}=l;return e.length<=1}),A=c(()=>d.value===0),F=c(()=>d.value===l.urlList.length-1),ae=c(()=>l.urlList[d.value]),te=c(()=>[o.e("btn"),o.e("prev"),o.is("disabled",!l.infinite&&A.value)]),Y=c(()=>[o.e("btn"),o.e("next"),o.is("disabled",!l.infinite&&F.value)]),ne=c(()=>{const{scale:e,deg:n,offsetX:s,offsetY:m,enableTransition:L}=r.value;let y=s/e,C=m/e;switch(n%360){case 90:case-270:[y,C]=[C,-y];break;case 180:case-180:[y,C]=[-y,-C];break;case 270:case-90:[y,C]=[-C,y];break}const R={transform:`scale(${e}) rotate(${n}deg) translate(${y}px, ${C}px)`,transition:L?"transform .3s":""};return f.value.name===O.CONTAIN.name&&(R.maxWidth=R.maxHeight="100%"),R}),H=c(()=>de(l.zIndex)?l.zIndex:ee());function $(){oe(),v("close")}function se(){const e=le(s=>{switch(s.code){case M.esc:l.closeOnPressEscape&&$();break;case M.space:W();break;case M.left:Z();break;case M.up:a("zoomIn");break;case M.right:G();break;case M.down:a("zoomOut");break}}),n=le(s=>{const m=s.deltaY||s.deltaX;a(m<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})});z.run(()=>{V(document,"keydown",e),V(document,"wheel",n)})}function oe(){z.stop()}function j(){h.value=!1}function q(e){h.value=!1,e.target.alt=_("el.image.error")}function K(e){if(h.value||e.button!==0||!T.value)return;r.value.enableTransition=!1;const{offsetX:n,offsetY:s}=r.value,m=e.pageX,L=e.pageY,y=le(R=>{r.value={...r.value,offsetX:n+R.pageX-m,offsetY:s+R.pageY-L}}),C=V(document,"mousemove",y);V(document,"mouseup",()=>{C()}),e.preventDefault()}function D(){r.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function W(){if(h.value)return;const e=De(O),n=Object.values(O),s=f.value.name,L=(n.findIndex(y=>y.name===s)+1)%e.length;f.value=O[e[L]],D()}function P(e){const n=l.urlList.length;d.value=(e+n)%n}function Z(){A.value&&!l.infinite||P(d.value-1)}function G(){F.value&&!l.infinite||P(d.value+1)}function a(e,n={}){if(h.value)return;const{zoomRate:s,rotateDeg:m,enableTransition:L}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...n};switch(e){case"zoomOut":r.value.scale>.2&&(r.value.scale=Number.parseFloat((r.value.scale/s).toFixed(3)));break;case"zoomIn":r.value.scale<7&&(r.value.scale=Number.parseFloat((r.value.scale*s).toFixed(3)));break;case"clockwise":r.value.deg+=m;break;case"anticlockwise":r.value.deg-=m;break}r.value.enableTransition=L}return ie(ae,()=>{we(()=>{const e=x.value[0];e!=null&&e.complete||(h.value=!0)})}),ie(d,e=>{D(),v("switch",e)}),ye(()=>{var e,n;se(),(n=(e=T.value)==null?void 0:e.focus)==null||n.call(e)}),S({setActiveItem:P}),(e,n)=>(g(),ue(Ye,{to:"body",disabled:!e.teleported},[i(Be,{name:"viewer-fade",appear:""},{default:b(()=>[p("div",{ref_key:"wrapper",ref:T,tabindex:-1,class:u(t(o).e("wrapper")),style:ce({zIndex:t(H)})},[p("div",{class:u(t(o).e("mask")),onClick:n[0]||(n[0]=Ce(s=>e.hideOnClickModal&&$(),["self"]))},null,2),I(" CLOSE "),p("span",{class:u([t(o).e("btn"),t(o).e("close")]),onClick:$},[i(t(N),null,{default:b(()=>[i(t(Ee))]),_:1})],2),I(" ARROW "),t(B)?I("v-if",!0):(g(),E(Q,{key:0},[p("span",{class:u(t(te)),onClick:Z},[i(t(N),null,{default:b(()=>[i(t(xe))]),_:1})],2),p("span",{class:u(t(Y)),onClick:G},[i(t(N),null,{default:b(()=>[i(t(Ne))]),_:1})],2)],64)),I(" ACTIONS "),p("div",{class:u([t(o).e("btn"),t(o).e("actions")])},[p("div",{class:u(t(o).e("actions__inner"))},[i(t(N),{onClick:n[1]||(n[1]=s=>a("zoomOut"))},{default:b(()=>[i(t(Se))]),_:1}),i(t(N),{onClick:n[2]||(n[2]=s=>a("zoomIn"))},{default:b(()=>[i(t(Oe))]),_:1}),p("i",{class:u(t(o).e("actions__divider"))},null,2),i(t(N),{onClick:W},{default:b(()=>[(g(),ue(Te(t(f).icon)))]),_:1}),p("i",{class:u(t(o).e("actions__divider"))},null,2),i(t(N),{onClick:n[3]||(n[3]=s=>a("anticlockwise"))},{default:b(()=>[i(t($e))]),_:1}),i(t(N),{onClick:n[4]||(n[4]=s=>a("clockwise"))},{default:b(()=>[i(t(Ae))]),_:1})],2)],2),I(" CANVAS "),p("div",{class:u(t(o).e("canvas"))},[(g(!0),E(Q,null,Re(e.urlList,(s,m)=>Me((g(),E("img",{ref_for:!0,ref:L=>x.value[m]=L,key:s,src:s,style:ce(t(ne)),class:u(t(o).e("img")),onLoad:j,onError:q,onMousedown:K},null,46,Qe)),[[Ve,m===d.value]])),128))],2),J(e.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var aa=ke(ea,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const ta=he(aa),na=ve({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:re([String,Object])},previewSrcList:{type:re(Array),default:()=>me([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),sa={load:w=>w instanceof Event,error:w=>w instanceof Event,switch:w=>de(w),close:()=>!0,show:()=>!0},oa=["src","loading"],la={key:0},ra=U({name:"ElImage",inheritAttrs:!1}),ia=U({...ra,props:na,emits:sa,setup(w,{emit:S}){const v=w;let l="";const{t:O}=pe(),_=ge("image"),o=Pe(),ee=Xe(),T=k(),x=k(!1),z=k(!0),h=k(!1),d=k(),f=k(),r=X&&"loading"in HTMLImageElement.prototype;let B,A;const F=c(()=>[_.e("inner"),Y.value&&_.e("preview"),z.value&&_.is("loading")]),ae=c(()=>o.style),te=c(()=>{const{fit:a}=v;return X&&a?{objectFit:a}:{}}),Y=c(()=>{const{previewSrcList:a}=v;return Array.isArray(a)&&a.length>0}),ne=c(()=>{const{previewSrcList:a,initialIndex:e}=v;let n=e;return e>a.length-1&&(n=0),n}),H=c(()=>v.loading==="eager"?!1:!r&&v.loading==="lazy"||v.lazy),$=()=>{X&&(z.value=!0,x.value=!1,T.value=v.src)};function se(a){z.value=!1,x.value=!1,S("load",a)}function oe(a){z.value=!1,x.value=!0,S("error",a)}function j(){Ze(d.value,f.value)&&($(),D())}const q=We(j,200,!0);async function K(){var a;if(!X)return;await we();const{scrollContainer:e}=v;je(e)?f.value=e:qe(e)&&e!==""?f.value=(a=document.querySelector(e))!=null?a:void 0:d.value&&(f.value=Ke(d.value)),f.value&&(B=V(f,"scroll",q),setTimeout(()=>j(),100))}function D(){!X||!f.value||!q||(B==null||B(),f.value=void 0)}function W(a){if(a.ctrlKey){if(a.deltaY<0)return a.preventDefault(),!1;if(a.deltaY>0)return a.preventDefault(),!1}}function P(){Y.value&&(A=V("wheel",W,{passive:!1}),l=document.body.style.overflow,document.body.style.overflow="hidden",h.value=!0,S("show"))}function Z(){A==null||A(),document.body.style.overflow=l,h.value=!1,S("close")}function G(a){S("switch",a)}return ie(()=>v.src,()=>{H.value?(z.value=!0,x.value=!1,D(),K()):$()}),ye(()=>{H.value?K():$()}),(a,e)=>(g(),E("div",{ref_key:"container",ref:d,class:u([t(_).b(),a.$attrs.class]),style:ce(t(ae))},[x.value?J(a.$slots,"error",{key:0},()=>[p("div",{class:u(t(_).e("error"))},Fe(t(O)("el.image.error")),3)]):(g(),E(Q,{key:1},[T.value!==void 0?(g(),E("img",He({key:0},t(ee),{src:T.value,loading:a.loading,style:t(te),class:t(F),onClick:P,onLoad:se,onError:oe}),null,16,oa)):I("v-if",!0),z.value?(g(),E("div",{key:1,class:u(t(_).e("wrapper"))},[J(a.$slots,"placeholder",{},()=>[p("div",{class:u(t(_).e("placeholder"))},null,2)])],2)):I("v-if",!0)],64)),t(Y)?(g(),E(Q,{key:2},[h.value?(g(),ue(t(ta),{key:0,"z-index":a.zIndex,"initial-index":t(ne),infinite:a.infinite,"zoom-rate":a.zoomRate,"url-list":a.previewSrcList,"hide-on-click-modal":a.hideOnClickModal,teleported:a.previewTeleported,"close-on-press-escape":a.closeOnPressEscape,onClose:Z,onSwitch:G},{default:b(()=>[a.$slots.viewer?(g(),E("div",la,[J(a.$slots,"viewer")])):I("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):I("v-if",!0)],64)):I("v-if",!0)],6))}});var ua=ke(ia,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const va=he(ua);export{va as E,na as i};
