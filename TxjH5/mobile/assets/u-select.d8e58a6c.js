import{_ as e,a as t,b as l,o as a,e as s,f as u,g as i,s as o,y as n,h as c,t as m,i as h,F as d,l as r,k as p,bz as f,bA as _}from"./index-7044850c.js";import{_ as y}from"./u-popup.449ebc77.js";const v=e({emits:["update:modelValue","input","confirm"],props:{value:{type:Boolean,default:!1},modelValue:{type:Boolean,default:!1},list:{type:Array,default:()=>[]},border:{type:Boolean,default:!0},cancelColor:{type:String,default:"#606266"},confirmColor:{type:String,default:"#2979ff"},zIndex:{type:[String,Number],default:0},safeAreaInsetBottom:{type:Boolean,default:!1},maskCloseAble:{type:Boolean,default:!0},defaultValue:{type:Array,default:()=>[0]},mode:{type:String,default:"single-column"},valueName:{type:String,default:"value"},labelName:{type:String,default:"label"},childName:{type:String,default:"children"},title:{type:String,default:""},cancelText:{type:String,default:"取消"},confirmText:{type:String,default:"确认"},blur:{type:[Number,String],default:0}},data:()=>({popupValue:!1,defaultSelector:[0],columnData:[],selectValue:[],lastSelectIndex:[],columnNum:0,moving:!1}),watch:{value:{immediate:!0,handler(e){e&&setTimeout((()=>this.init()),10),this.popupValue=e}},modelValue:{immediate:!0,handler(e){e&&setTimeout((()=>this.init()),10),this.popupValue=e}}},computed:{uZIndex(){return this.zIndex?this.zIndex:this.$u.zIndex.popup}},methods:{pickstart(){},pickend(){},init(){this.setColumnNum(),this.setDefaultSelector(),this.setColumnData(),this.setSelectValue()},setDefaultSelector(){this.defaultSelector=this.defaultValue.length==this.columnNum?this.defaultValue:Array(this.columnNum).fill(0),this.lastSelectIndex=this.$u.deepClone(this.defaultSelector)},setColumnNum(){if("single-column"==this.mode)this.columnNum=1;else if("mutil-column"==this.mode)this.columnNum=this.list.length;else if("mutil-column-auto"==this.mode){let e=1,t=this.list;for(;t[0][this.childName];)t=t[0]?t[0][this.childName]:{},e++;this.columnNum=e}},setColumnData(){let e=[];if(this.selectValue=[],"mutil-column-auto"==this.mode){let t=this.list[this.defaultSelector.length?this.defaultSelector[0]:0];for(let l=0;l<this.columnNum;l++)0==l?(e[l]=this.list,t=t[this.childName]):(e[l]=t,t=t[this.defaultSelector[l]][this.childName])}else"single-column"==this.mode?e[0]=this.list:e=this.list;this.columnData=e},setSelectValue(){let e=null;for(let t=0;t<this.columnNum;t++){e=this.columnData[t][this.defaultSelector[t]];let l={value:e?e[this.valueName]:null,label:e?e[this.labelName]:null};e&&e.extra&&(l.extra=e.extra),this.selectValue.push(l)}},columnChange(e){let t=null,l=e.detail.value;if(this.selectValue=[],"mutil-column-auto"==this.mode){this.lastSelectIndex.map(((e,a)=>{e!=l[a]&&(t=a)})),this.defaultSelector=l;for(let e=t+1;e<this.columnNum;e++)this.columnData[e]=this.columnData[e-1][e-1==t?l[t]:0][this.childName],this.defaultSelector[e]=0;l.map(((e,t)=>{let a=this.columnData[t][l[t]],s={value:a?a[this.valueName]:null,label:a?a[this.labelName]:null};a&&void 0!==a.extra&&(s.extra=a.extra),this.selectValue.push(s)})),this.lastSelectIndex=l}else if("single-column"==this.mode){let e=this.columnData[0][l[0]],t={value:e?e[this.valueName]:null,label:e?e[this.labelName]:null};e&&void 0!==e.extra&&(t.extra=e.extra),this.selectValue.push(t)}else"mutil-column"==this.mode&&l.map(((e,t)=>{let a=this.columnData[t][l[t]],s={value:a?a[this.valueName]:null,label:a?a[this.labelName]:null};a&&void 0!==a.extra&&(s.extra=a.extra),this.selectValue.push(s)}))},close(){this.$emit("input",!1),this.$emit("update:modelValue",!1)},getResult(e=null){e&&this.$emit(e,this.selectValue),this.close()},selectHandler(){this.$emit("click")}}},[["render",function(e,v,b,x,N,g){const S=p,V=f,C=_,k=t(l("u-popup"),y);return a(),s(S,{class:"u-select"},{default:u((()=>[i(k,{blur:b.blur,maskCloseAble:b.maskCloseAble,mode:"bottom",popup:!1,modelValue:N.popupValue,"onUpdate:modelValue":v[4]||(v[4]=e=>N.popupValue=e),length:"auto",safeAreaInsetBottom:b.safeAreaInsetBottom,onClose:g.close,"z-index":g.uZIndex},{default:u((()=>[i(S,{class:"u-select"},{default:u((()=>[i(S,{class:"u-select__header",onTouchmove:v[3]||(v[3]=o((()=>{}),["stop","prevent"]))},{default:u((()=>[i(S,{class:"u-select__header__cancel u-select__header__btn",style:n({color:b.cancelColor}),"hover-class":"u-hover-class","hover-stay-time":150,onClick:v[0]||(v[0]=e=>g.getResult("cancel"))},{default:u((()=>[c(m(b.cancelText),1)])),_:1},8,["style"]),i(S,{class:"u-select__header__title"},{default:u((()=>[c(m(b.title),1)])),_:1}),i(S,{class:"u-select__header__confirm u-select__header__btn",style:n({color:N.moving?b.cancelColor:b.confirmColor}),"hover-class":"u-hover-class","hover-stay-time":150,onTouchmove:v[1]||(v[1]=o((()=>{}),["stop"])),onClick:v[2]||(v[2]=o((e=>g.getResult("confirm")),["stop"]))},{default:u((()=>[c(m(b.confirmText),1)])),_:1},8,["style"])])),_:1}),i(S,{class:"u-select__body"},{default:u((()=>[i(C,{onChange:g.columnChange,class:"u-select__body__picker-view",value:N.defaultSelector,onPickstart:g.pickstart,onPickend:g.pickend},{default:u((()=>[(a(!0),h(d,null,r(N.columnData,((e,t)=>(a(),s(V,{key:t},{default:u((()=>[(a(!0),h(d,null,r(e,((e,t)=>(a(),s(S,{class:"u-select__body__picker-view__item",key:t},{default:u((()=>[i(S,{class:"u-line-1"},{default:u((()=>[c(m(e[b.labelName]),1)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)))),128))])),_:1},8,["onChange","value","onPickstart","onPickend"])])),_:1})])),_:1})])),_:1},8,["blur","maskCloseAble","modelValue","safeAreaInsetBottom","onClose","z-index"])])),_:1})}],["__scopeId","data-v-6d36d0a6"]]);export{v as _};
