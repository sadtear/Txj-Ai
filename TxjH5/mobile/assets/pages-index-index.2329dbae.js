import{_ as e}from"./page-meta.66d6713f.js";import{d as l,r as a,c as t,w as s,a as o,b as u,o as n,e as r,f as i,g as p,h as d,t as m,u as c,i as f,F as x,j as _,n as g,k as y,l as v,m as h,S as b,p as k,q as V,I as w,s as C,v as j,x as I,y as L,z as B,N as S,A as U,B as z,C as D,_ as A}from"./index-7044850c.js";import{u as F,_ as T}from"./useSessionList.4145dc65.js";import{_ as E}from"./tabbar.vue_vue_type_script_setup_true_lang.ba1d1694.js";import{C as R}from"./chat-model-view.9f6c296d.js";import{_ as H}from"./u-button.5deae2bc.js";import{_ as N}from"./u-popup.449ebc77.js";import{u as O}from"./useLockFn.b248adc4.js";import{_ as q}from"./u-icon.593ee39b.js";import{_ as G}from"./u-input.1eff233e.js";import{_ as J}from"./mp-html.37ba915e.js";import{g as K,a as M}from"./chat.e60728da.js";import{_ as P}from"./u-empty.bbf2d5af.js";import"./u-badge.900e45cf.js";const Q=l({__name:"session-item",props:{modelValue:null,name:null,itemId:null},emits:["update:modelValue","edit","delete"],setup(e,{emit:l}){const v=e,h=a(""),b=a(!1),k=t({get:()=>v.modelValue,set(e){l("update:modelValue",e)}}),V=t((()=>k.value===v.itemId)),w=()=>{b.value=!1,l("edit",v.itemId,h.value)};return s((()=>v.modelValue),(()=>{b.value=!1})),s((()=>v.name),(e=>{h.value=e}),{immediate:!0}),(a,t)=>{const s=o(u("u-icon"),q),v=o(u("u-input"),G),C=y;return n(),r(C,{class:g(["px-[20rpx] h-[80rpx] flex items-center rounded-[8rpx] mb-[20rpx] cursor-pointer",{" bg-page":c(V)}]),onClick:t[4]||(t[4]=l=>k.value=e.itemId)},{default:i((()=>[p(s,{name:"chat"}),p(C,{class:"ml-[20rpx] flex-1 min-w-0"},{default:i((()=>[b.value?(n(),r(v,{key:0,height:"50","custom-style":{fontSize:"26rpx"},modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=e=>h.value=e),border:""},null,8,["modelValue"])):(n(),r(C,{key:1,class:"line-clamp-1"},{default:i((()=>[d(m(e.name),1)])),_:1}))])),_:1}),c(V)?(n(),f(x,{key:0},[b.value?(n(),f(x,{key:0},[p(C,{class:"cursor-pointer mx-[12rpx] flex h-full",onClick:w},{default:i((()=>[p(s,{name:"checkbox-mark"})])),_:1}),p(C,{class:"cursor-pointer flex h-full",onClick:t[1]||(t[1]=e=>b.value=!1)},{default:i((()=>[p(s,{name:"close"})])),_:1})],64)):(n(),f(x,{key:1},[p(C,{class:"cursor-pointer mr-[12rpx] flex h-full",onClick:t[2]||(t[2]=e=>b.value=!0)},{default:i((()=>[p(s,{name:"edit-pen"})])),_:1}),p(C,{class:"cursor-pointer flex h-full",onClick:t[3]||(t[3]=a=>l("delete",e.itemId))},{default:i((()=>[p(s,{name:"trash"})])),_:1})],64))],64)):_("",!0)])),_:1},8,["class"])}}}),$=l({__name:"session-popup",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:l}){const a=e,s=t({get:()=>a.modelValue,set:e=>{l("update:modelValue",e)}}),{sessionLists:m,sessionAdd:_,sessionEdit:g,sessionDelete:k,sessionClear:V,sessionActive:w}=F(),{lockFn:C,isLock:j}=O((async()=>{await _()}));return(e,l)=>{const a=o(u("u-button"),H),t=y,_=b,I=o(u("u-popup"),N);return n(),r(I,{modelValue:c(s),"onUpdate:modelValue":l[1]||(l[1]=e=>h(s)?s.value=e:null),mode:"left",width:"480rpx","safe-area-inset-bottom":""},{default:i((()=>[p(t,{class:"flex flex-col h-full relative z-[9999]"},{default:i((()=>[p(t,{class:"px-[20rpx] py-[20rpx]"},{default:i((()=>[p(a,{type:"primary","custom-style":{width:"100%"},onClick:c(C),loading:c(j)},{default:i((()=>[d(" + 新建会话 ")])),_:1},8,["onClick","loading"])])),_:1}),p(t,{class:"flex-1 min-h-0"},{default:i((()=>[p(_,{"scroll-y":"",class:"h-full"},{default:i((()=>[p(t,{class:"px-[20rpx]"},{default:i((()=>[(n(!0),f(x,null,v(c(m),(e=>(n(),r(t,{key:e.id},{default:i((()=>[p(Q,{modelValue:c(w),"onUpdate:modelValue":l[0]||(l[0]=e=>h(w)?w.value=e:null),"item-id":e.id,name:e.name,onEdit:c(g),onDelete:c(k)},null,8,["modelValue","item-id","name","onEdit","onDelete"])])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1}),p(t,{class:"px-[20rpx] py-[20rpx]"},{default:i((()=>[p(a,{"custom-style":{width:"100%"},onClick:c(V)},{default:i((()=>[d(" 删除所有会话 ")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}}}),W=l({__name:"follow-official",props:{title:{default:"👉🏻关注公众号，下次访问不迷路"},show:{type:Boolean,default:!1}},setup(e){const l=a(!1),t=()=>{V.set(w,!0,86400),l.value=!1};return k((()=>{l.value=!V.get(w)})),(a,s)=>{const c=y,f=o(u("u-button"),H),x=j("router-navigate"),g=o(u("u-icon"),q);return e.show&&l.value?(n(),r(c,{key:0,class:"bg-primary flex px-[20rpx] items-center py-[16rpx]"},{default:i((()=>[p(c,{class:"flex-1 line-clamp-1 min-w-0 text-btn-text"},{default:i((()=>[d(m(e.title),1)])),_:1}),p(x,{to:"/pages/follow_official/follow_official"},{default:i((()=>[p(f,{class:"flex-none",plain:!0,type:"primary",size:"medium",shape:"circle","hover-class":"none","custom-style":{height:"60rpx"}},{default:i((()=>[d(" 前往关注 ")])),_:1})])),_:1}),p(c,{class:"text-btn-text ml-[10rpx]",onClick:C(t,["stop"])},{default:i((()=>[p(g,{name:"close"})])),_:1},8,["onClick"])])),_:1})):_("",!0)}}}),X=l({__name:"notice-popup",setup(e){const l=I(),f=a(!1),x=t((()=>l.getBulletinConfig.title)),_=t((()=>l.getBulletinConfig.content)),g=t((()=>1==l.getBulletinConfig.status));return s((()=>g.value),(e=>{e&&(e=>{const l=V.get(S),a=(new Date).toDateString(),t=!l||l!==a;return t&&e&&V.set(S,a),t})(e)&&(f.value=!0)}),{deep:!0,immediate:!0}),(e,l)=>{const a=y,t=o(u("mp-html"),J),s=b,g=B,v=o(u("u-popup"),N);return n(),r(v,{modelValue:f.value,"onUpdate:modelValue":l[1]||(l[1]=e=>f.value=e),mode:"center","border-radius":"24"},{default:i((()=>[p(a,{class:"w-[90vw] px-[24rpx]",style:{"background-color":"rgb(37,36,41)",color:"#fff"}},{default:i((()=>[p(a,{class:"p-[30rpx] text-lg text-center font-medium"},{default:i((()=>[d(m(c(x)),1)])),_:1}),p(s,{class:"max-h-[768rpx]","scroll-y":""},{default:i((()=>[p(t,{content:c(_)},null,8,["content"])])),_:1}),p(a,{class:"py-[30rpx] bg-white",style:{"background-color":"rgb(37,36,41)",color:"#fff"}},{default:i((()=>[p(g,{style:L({height:"82rpx",lineHeight:"82rpx",fontSize:"30rpx",border:"none",borderRadius:"60px",background:"var(--color-primary)"}),onClick:l[0]||(l[0]=e=>f.value=!1)},{default:i((()=>[d(" 我知道了 ")])),_:1},8,["style"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}}}),Y=l({__name:"problem-example-popup",props:{data:null,modelValue:{type:Boolean}},emits:["update:modelValue","click-item"],setup(e,{emit:l}){const s=e,_=t({get:()=>s.modelValue,set:e=>{l("update:modelValue",e)}}),k=a(0),V=t((()=>{var e;return(null==(e=s.data[k.value])?void 0:e.sampleList)||[]}));return(a,t)=>{const s=y,w=b,C=o(u("u-empty"),P),j=o(u("u-popup"),N);return n(),r(j,{modelValue:c(_),"onUpdate:modelValue":t[0]||(t[0]=e=>h(_)?_.value=e:null),height:"1000rpx",mode:"bottom","safe-area-inset-bottom":"","border-radius":"14",closeable:""},{default:i((()=>[p(s,{class:"py-[30rpx] h-full flex flex-col"},{default:i((()=>[p(s,{class:"text-2xl font-medium px-[30rpx]"},{default:i((()=>[d("问题示例")])),_:1}),p(s,null,{default:i((()=>[p(w,{"scroll-x":!0,class:"whitespace-nowrap"},{default:i((()=>[p(s,{class:"inline-block py-[20rpx]"},{default:i((()=>[p(s,{class:"flex px-[15rpx]"},{default:i((()=>[(n(!0),f(x,null,v(e.data,((e,l)=>(n(),r(s,{class:g(["mx-[15rpx] leading-[72rpx] px-[40rpx] bg-primary-light-9 text-primary rounded-[8rpx]",{"!text-btn-text !bg-primary":k.value==l}]),key:e.id,onClick:e=>k.value=l},{default:i((()=>[p(s,null,{default:i((()=>[d(m(e.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1}),p(s,{class:"border-0 border-t border-light border-solid flex-1 min-h-0 leading-[72rpx]"},{default:i((()=>[p(w,{class:"h-full","scroll-y":!0},{default:i((()=>[p(s,{class:"px-[30rpx] py-[20rpx]"},{default:i((()=>[c(V).length?(n(!0),f(x,{key:0},v(c(V),(e=>(n(),r(s,{key:e.id,class:"py-[10rpx]"},{default:i((()=>[p(s,{class:"text-center px-[20rpx] bg-page rounded",onClick:a=>{return t=e.content,_.value=!1,void l("click-item",t);var t}},{default:i((()=>[d(m(e.content),1)])),_:2},1032,["onClick"])])),_:2},1024)))),128)):(n(),r(s,{key:1,class:"py-[150rpx]"},{default:i((()=>[p(C,{text:"暂无数据",mode:"data"})])),_:1}))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])}}}),Z=A(l({__name:"index",setup(l){const{getSessionLists:t,sessionActive:r}=F(),d=a(!1),m=a(!1),_=a([]),g=a([]),v=U();z({tips:{show:0,title:"",sub_title:""}});const h=U(),b=I();return s(r,(async e=>{e&&(await(async()=>{const e=await M({type:1,categoryId:r.value});g.value=e})(),setTimeout((()=>{var e,l;g.value.length?null==(l=v.value)||l.scrollToBottom():null==(e=v.value)||e.scrollTo(0)}),200)),(async()=>{_.value=await K()})()}),{immediate:!0}),D((async()=>{await t()})),(l,a)=>{const t=o(u("page-meta"),e),s=o(u("dialog-poster"),T),r=y,g=o(u("tabbar"),E);return n(),f(x,null,[p(t,{"page-style":l.$theme.pageStyle},null,8,["page-style"]),p(r,{class:"h-full flex flex-col"},{default:i((()=>[p(W,{show:!!c(b).getLoginConfig.followOfficial,title:c(b).getLoginConfig.involvedText},null,8,["show","title"]),p(r,{class:"flex-1 min-h-0 bg-[#1c1c1e]"},{default:i((()=>[p(R),p(s,{ref_key:"posterRef",ref:h},null,512),p($,{modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=e=>d.value=e)},null,8,["modelValue"]),p(Y,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=e=>m.value=e),data:_.value,onClickItem:a[2]||(a[2]=e=>c(v).sendLock(e))},null,8,["modelValue","data"]),p(X)])),_:1}),p(g)])),_:1})],64)}}}),[["__scopeId","data-v-da3e13a4"]]);export{Z as default};
