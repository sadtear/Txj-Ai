import{d as e,r as a,aI as l,A as t,$ as u,C as s,aJ as o,W as r,o as n,i as d,g as c,f as i,h as v,t as m,F as f,aK as p,Q as _,R as x,aL as b,H as h,X as y,Y as w,Z as k,K as V,k as g,z as C,a as j,b as A,a0 as $,a1 as U,aM as E,_ as N}from"./index-7044850c.js";import{_ as B}from"./u-icon.593ee39b.js";import{_ as I}from"./u-button.5deae2bc.js";import{_ as M}from"./u-form-item.9f9aa37f.js";import{_ as z}from"./u-popup.449ebc77.js";import{_ as K}from"./u-input.1eff233e.js";import{_ as R}from"./u-picker.28f70a2f.js";import{_ as T}from"./u-verification-code.948df417.js";const F=N(e({__name:"user_data",setup(e){const N=a({}),F=a(l.NONE),L=a(["男","女"]),O=a(!1),S=a(!1),W=a(!1),G=a(!1),H=a(""),J=a(""),X=a(""),D=a(""),Q=a(""),Y=t(),Z=async()=>{N.value=await p()},q=e=>{Q.value=e},P=async()=>{var e,a;if(!X.value)return uni.$u.toast("请输入新的手机号码");(null==(e=Y.value)?void 0:e.canGetCode)&&(await _({scene:N.value.mobile?x.CHANGE_MOBILE:x.BIND_MOBILE,mobile:X.value}),uni.$u.toast("发送成功"),null==(a=Y.value)||a.start())},ee=async()=>{await b({type:N.value.mobile?"change":"bind",mobile:X.value,code:D.value}),uni.$u.toast("操作成功"),G.value=!1,Z()},ae=async e=>{await E({field:F.value,value:e}),uni.$u.toast("操作成功"),Z()},le=e=>{F.value=l.AVATAR,h({url:"/uni_modules/vk-uview-ui/components/u-avatar-cropper/u-avatar-cropper?destWidth=300&rectWidth=200&fileType=jpg"})},te=()=>{W.value=!0,F.value=l.SEX},ue=e=>{ae(e[0]+1),W.value=!1},se=async()=>""==J.value?uni.$u.toast("账号不能为空"):J.value.length>10?uni.$u.toast("账号长度不得超过十位数"):(F.value=l.USERNAME,await ae(J.value),void(S.value=!1)),oe=async e=>(H.value=e.detail.value.nickname,""==H.value?uni.$u.toast("昵称不能为空"):H.value.length>10?uni.$u.toast("昵称长度不得超过十位数"):(F.value=l.NICKNAME,await ae(H.value),void(O.value=!1)));return u("uAvatarCropper",(e=>{(e=>{y({title:"正在上传中...",mask:!0}),w(e).then((e=>{k(),ae(e.url)})).catch((()=>{k(),uni.$u.toast("上传失败")}))})(e)})),s((async()=>{Z()})),o((()=>{r("uAvatarCropper")})),(e,a)=>{const l=V,t=g,u=C,s=j(A("u-icon"),B),o=j(A("u-button"),I),r=$,p=j(A("u-form-item"),M),_=U,x=j(A("u-popup"),z),b=j(A("u-input"),K),h=j(A("u-picker"),R),y=j(A("u-verification-code"),T);return n(),d(f,null,[c(t,{class:"page-box"},{default:i((()=>[c(t,{class:"header py-[30rpx]"},{default:i((()=>[c(t,{class:"flex"},{default:i((()=>[c(u,{class:"flex flex-col items-center after:border-0","hover-class":"none","open-type":"chooseAvatar",style:{"background-color":"transparent"},onClick:le,onChooseavatar:le},{default:i((()=>{var e;return[c(l,{src:null==(e=N.value)?void 0:e.avatar},null,8,["src"]),c(t,{class:"mt-[10rpx] text-center text-muted text-xs"},{default:i((()=>[v(" 点击修改头像 ")])),_:1})]})),_:1})])),_:1})])),_:1}),c(t,{class:"item text-nr flex justify-between",onClick:a[0]||(a[0]=e=>{var a;S.value=!0,J.value=null==(a=N.value)?void 0:a.username})},{default:i((()=>[c(t,{class:"label"},{default:i((()=>[v("账号")])),_:1}),c(t,{class:"content"},{default:i((()=>{var e;return[v(m(null==(e=N.value)?void 0:e.username),1)]})),_:1}),c(s,{name:"arrow-right",size:"22",color:"#666"})])),_:1}),c(t,{class:"item text-nr flex justify-between",onClick:a[1]||(a[1]=e=>{var a;O.value=!0,H.value=null==(a=N.value)?void 0:a.nickname})},{default:i((()=>[c(t,{class:"label"},{default:i((()=>[v("昵称")])),_:1}),c(t,{class:"content"},{default:i((()=>{var e;return[v(m(null==(e=N.value)?void 0:e.nickname),1)]})),_:1}),c(s,{name:"arrow-right",size:"22",color:"#666"})])),_:1}),c(t,{class:"item text-nr flex justify-between",onClick:te},{default:i((()=>[c(t,{class:"label"},{default:i((()=>[v("性别")])),_:1}),c(t,{class:"content"},{default:i((()=>{var e;return[v(m(null==(e=N.value)?void 0:e.sex),1)]})),_:1}),c(s,{name:"arrow-right",size:"22",color:"#666"})])),_:1}),c(t,{class:"item text-nr flex justify-between"},{default:i((()=>[c(t,{class:"label"},{default:i((()=>[v("手机号")])),_:1}),c(t,{class:"content"},{default:i((()=>{var e,a;return[v(m(""==(null==(e=N.value)?void 0:e.mobile)?"未绑定手机号":null==(a=N.value)?void 0:a.mobile),1)]})),_:1}),c(o,{onClick:a[2]||(a[2]=e=>G.value=!0),size:"mini",shape:"circle",plain:!0},{default:i((()=>{var e;return[v(m(""==(null==(e=N.value)?void 0:e.mobile)?"绑定手机号":"更换手机号"),1)]})),_:1})])),_:1}),c(t,{class:"item text-nr flex justify-between"},{default:i((()=>[c(t,{class:"label"},{default:i((()=>[v("注册时间")])),_:1}),c(t,{class:"content"},{default:i((()=>{var e;return[v(m(null==(e=N.value)?void 0:e.createTime),1)]})),_:1})])),_:1})])),_:1}),c(x,{modelValue:O.value,"onUpdate:modelValue":a[3]||(a[3]=e=>O.value=e),closeable:!0,mode:"center",maskCloseAble:!1,"border-radius":"20"},{default:i((()=>[c(t,{class:"px-[50rpx] py-[40rpx] bg-white",style:{width:"85vw"}},{default:i((()=>[c(_,{onSubmit:oe},{default:i((()=>[c(t,{class:"mb-[70rpx] text-xl text-center"},{default:i((()=>[v("修改昵称")])),_:1}),c(p,{borderBottom:""},{default:i((()=>[c(r,{class:"nr h-[60rpx] w-full",value:N.value.nickname,name:"nickname",type:"nickname",placeholder:"请输入昵称"},null,8,["value"])])),_:1}),c(t,{class:"mt-[80rpx]"},{default:i((()=>[c(o,{type:"success",shape:"circle","form-type":"submit"},{default:i((()=>[v(" 确定 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),c(x,{modelValue:S.value,"onUpdate:modelValue":a[5]||(a[5]=e=>S.value=e),closeable:!0,mode:"center","border-radius":"20"},{default:i((()=>[c(t,{class:"px-[50rpx] py-[40rpx] bg-white",style:{width:"85vw"}},{default:i((()=>[c(t,{class:"mb-[70rpx] text-xl text-center"},{default:i((()=>[v("修改账号")])),_:1}),c(p,{borderBottom:""},{default:i((()=>[c(b,{class:"flex-1",modelValue:J.value,"onUpdate:modelValue":a[4]||(a[4]=e=>J.value=e),placeholder:"请输入账号",border:!1},null,8,["modelValue"])])),_:1}),c(t,{class:"mt-[80rpx]"},{default:i((()=>[c(o,{onClick:se,type:"success",shape:"circle"},{default:i((()=>[v(" 确定 ")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),c(h,{mode:"selector",modelValue:W.value,"onUpdate:modelValue":a[6]||(a[6]=e=>W.value=e),"confirm-color":"#4173FF","default-selector":[0],range:L.value,onConfirm:ue},null,8,["modelValue","range"]),c(x,{modelValue:G.value,"onUpdate:modelValue":a[9]||(a[9]=e=>G.value=e),closeable:!0,mode:"center","border-radius":"20"},{default:i((()=>[c(t,{class:"px-[50rpx] py-[40rpx] bg-white",style:{width:"85vw"}},{default:i((()=>[c(t,{class:"mb-[70rpx] text-xl text-center"},{default:i((()=>[v("修改手机号码")])),_:1}),c(p,{borderBottom:""},{default:i((()=>[c(b,{class:"flex-1",modelValue:X.value,"onUpdate:modelValue":a[7]||(a[7]=e=>X.value=e),placeholder:"请输入新的手机号码",border:!1},null,8,["modelValue"])])),_:1}),c(p,{borderBottom:""},{default:i((()=>[c(b,{class:"flex-1",modelValue:D.value,"onUpdate:modelValue":a[8]||(a[8]=e=>D.value=e),placeholder:"请输入验证码",border:!1},null,8,["modelValue"]),c(t,{class:"border-l border-solid border-0 border-light pl-3 text-muted leading-4 ml-3 w-[180rpx]",onClick:P},{default:i((()=>[c(y,{ref_key:"uCodeRef",ref:Y,seconds:60,onChange:q,"change-text":"x秒"},null,512),v(" "+m(Q.value),1)])),_:1})])),_:1}),c(t,{class:"mt-[80rpx]"},{default:i((()=>[c(o,{onClick:ee,type:"success",shape:"circle"},{default:i((()=>[v(" 确定 ")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-a9d51438"]]);export{F as default};
